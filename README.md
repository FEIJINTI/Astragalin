# 黄芪分拣项目

2023年6月开始开发的项目

## 整体结构

   ```text
    Astragalin
    ├── README.md
    ├── data
    ├── models
    ├── classifer.py
    ├── main.py
    ├── utils.py
```
高光谱图像数据集放在data文件夹下，模型放在models文件夹下，classifer.py是分类器，main.py是主程序，utils.py是工具函数。

## 谱段选择

已给的高光谱图像有288个谱段，但是我们只需要用前110个谱段，并且在其中进行特征谱段优选

采用SelectKBest进行谱段选择，选择的方法是卡方检验，选择的谱段数目是10个，选择的谱段如下所示：

    [ 91  92  93  94  95  96  97  98  99 100]

## 模型训练

通过多个模型比较发现决策树的效果最优

所以采用的模型是DecisionTree，random_state=65，权重默认

将训练好的模型保存在models文件夹下

## 预测

读取data文件夹下的数据，进行预测

对不同类别进行颜色区分，分别用黑色表示背景、红色表示杂质1、绿色表示杂质2、蓝色表示黄芪、黄色表示甘草片、紫色表示红芪

对01newrawfile_ref.raw进行预测，结果如下所示：

![预测结果](./pics/预测结果.png)

## 连通域分析

对预测结果进行连通域分析，将个别像素的误识别进行剔除，结果如下所示：

![连通域分析之后的预测结果](./pics/连通域分析之后的预测结果.png)




